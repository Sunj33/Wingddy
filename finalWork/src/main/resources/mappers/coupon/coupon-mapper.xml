<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="coupon-mapper">
	<select id="selectListCount" parameterType="_int" resultType="_int">
		select NVL(count(*), 0)
		  from coupon_product_shop
		 where class_no = #{classNo}
	</select>
	
	<select id="selectCouponProductList" parameterType="couponProduct" resultType="couponProduct" >
		select 
		       product_no pNo
		      ,cart_no cartNo
		      ,product_name productName
		      ,product_content productContent
		      ,coupon_price CouponPrice
		      ,amount
		      ,class_no classNo
		      ,file_no fileNo
		      ,file_path || file_name filePath
		  from 
		       vw_cp
		 where 
		       class_no = #{classNo}
		 order by (case when #{orderBy} = 'coupon_price' then coupon_price asc
		 				when #{orderBy} = 'coupon_price desc then coupon_price desc
		 				when #{orderBy} = 'amount' then amount end)

	</select>
</mapper>